<div class="modal-header border-bottom mb-2 pt-0 d-flex justify-content-between">
    <div>
        <h1 class="modal-title text-muted mb-0">{{isEdit == true ? 'Update': 'Add'}} Attendance Regularizations Settings
        </h1>
    </div>
    <div class=""><button type="button" data-bs-dismiss="modal" class="btn-close text-end"
            (click)="closeModal()"></button>
    </div>
</div>

<form [formGroup]="regularisationForm" (ngSubmit)="onSubmission()">

    <div class="form-group">
        <label for="">Can employees regularize their own attendance entries?</label>
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input" type="radio" id="canEmpRegularizeOwnAttendance-Yes"
                    formControlName="canEmpRegularizeOwnAttendance" required [value]="true">
                <label class="form-check-label" for="canEmpRegularizeOwnAttendance-Yes">
                    Yes
                </label>
            </div>

            <div class="form-check ms-3">
                <input class="form-check-input" type="radio" id="canEmpRegularizeOwnAttendance-No"
                    formControlName="canEmpRegularizeOwnAttendance" required [value]="false">
                <label class="form-check-label" for="canEmpRegularizeOwnAttendance-No">
                    No
                </label>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label for="">Can supervisors regularize their subordinate's attendance entries?</label>
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input" type="radio" id="canSupervisorsRegularizeSubordinatesAttendance-Yes"
                    formControlName="canSupervisorsRegularizeSubordinatesAttendance" required [value]="true">
                <label class="form-check-label" for="canSupervisorsRegularizeSubordinatesAttendance-Yes">
                    Yes
                </label>
            </div>


            <div class="form-check ms-3">
                <input class="form-check-input" type="radio"
                    formControlName="canSupervisorsRegularizeSubordinatesAttendance"
                    id="canSupervisorsRegularizeSubordinatesAttendance-No" required [value]="false">
                <label class="form-check-label" for="canSupervisorsRegularizeSubordinatesAttendance-No">
                    No
                </label>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label for="">Can the admin edit regularize attendance entries?</label>
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input" type="radio" formControlName="canAdminEditRegularizeAttendance"
                    id="canAdminEditRegularizeAttendance-Yes" required [value]="true">
                <label class="form-check-label" for="canAdminEditRegularizeAttendance-Yes">
                    Yes
                </label>
            </div>


            <div class="form-check ms-3">
                <input class="form-check-input" type="radio" formControlName="canAdminEditRegularizeAttendance"
                    id="canAdminEditRegularizeAttendance-No" required [value]="false">
                <label class="form-check-label" for="canAdminEditRegularizeAttendance-No">
                    No
                </label>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label for="">Should weekly email notification for missing check in/check out be sent?<br>
            <strong>Note: </strong>Email notification will be sent out every week on Monday and on 1st day of a new
            attendance cycle.</label>
        <div class="form-check">
            <input class="form-check-input" type="radio" formControlName="shouldWeeklyEmailNotificationToBeSent"
                id="shouldWeeklyEmailNotificationToBeSent1-Yes" required value="Dont notify">
            <label class="form-check-label" for="shouldWeeklyEmailNotificationToBeSent1-Yes">
                Don't notify
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" formControlName="shouldWeeklyEmailNotificationToBeSent"
                id="shouldWeeklyEmailNotificationToBeSent2-Yes" required
                value="Send notification when only check out is missing on a working day">
            <label class="form-check-label" for="shouldWeeklyEmailNotificationToBeSent2-Yes">
                Send notification when only check out is missing on a working day
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" formControlName="shouldWeeklyEmailNotificationToBeSent"
                id="shouldWeeklyEmailNotificationToBeSent3-Yes" required
                value="Send notification when both check in and check out are missing on a working day">
            <label class="form-check-label" for="shouldWeeklyEmailNotificationToBeSent3-Yes">
                Send notification when both check in and check out are missing on a working day
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" formControlName="shouldWeeklyEmailNotificationToBeSent"
                id="shouldWeeklyEmailNotificationToBeSent4-Yes" required
                value="Send notification when either check out is missing or there is no entry on a working day">
            <label class="form-check-label" for="shouldWeeklyEmailNotificationToBeSent4-Yes">
                Send notification when either check out is missing or there is no entry on a working day
            </label>
        </div>
    </div>


    <div class="form-group"
        *ngIf="regularisationForm.get('shouldWeeklyEmailNotificationToBeSent').value === 'Dont notify'">
        <label for="">Who should receive weekly email notification for missing check in/check out?</label>
        <div class="d-flex">
            <div class="d-flex">
                <input type="checkbox" class="form-check-input me-2 checks" (change)="onCheckboxChange($event)"
                    [value]="'admin'"
                    [checked]="regularisationForm.get('whoReceiveWeeklyEmailNotification').value.includes('admin')"
                    id="admin">
                <label for="admin">Admin</label>
            </div>
            <div class="d-flex mx-2">
                <input type="checkbox" class="form-check-input me-2 checks" (change)="onCheckboxChange($event)"
                    [value]="'supervisors'"
                    [checked]="regularisationForm.get('whoReceiveWeeklyEmailNotification').value.includes('supervisors')"
                    id="supervisors">
                <label for="supervisors">Supervisor</label>
            </div>
            <div class="d-flex">
                <input type="checkbox" class="form-check-input me-2 checks" (change)="onCheckboxChange($event)"
                    [value]="'employees'"
                    [checked]="regularisationForm.get('whoReceiveWeeklyEmailNotification').value.includes('employees')"
                    id="employees">
                <label for="employees">Employees</label>
            </div>
        </div>
    </div>


    <div class="form-group">
        <label for="">Would you like to restrict the IP address that the employee can check-in/check-out?</label>
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input" type="radio" formControlName="isIPrestrictedEmployeeCheckInCheckOut"
                    id="restrict" required [value]="true">
                <label class="form-check-label" for="restrict">
                    Yes
                </label>
            </div>


            <div class="form-check ms-3">
                <input class="form-check-input" type="radio" formControlName="isIPrestrictedEmployeeCheckInCheckOut"
                    id="restrict-No" required [value]="false">
                <label class="form-check-label" for="restrict-No">
                    No
                </label>
            </div>
        </div>
    </div>
    <div class="form-group" *ngIf="regularisationForm.get('isIPrestrictedEmployeeCheckInCheckOut').value === 'true'">
        <label for=""><small>IP Configurations</small><br>
            Please enter all IP addresses that the employee can log in from to check-in/check-out</label>
        <button class="submenuTab rounded-pill active" type="button" (click)="addField()">Add</button>
        <div formArrayName="IPDetails">
            <div class="categoryField"
                *ngFor="let fieldGroup of regularisationForm.get('IPDetails')['controls']; let i = index">
                <ng-container [formGroupName]="i">
                    <div class="my-2 d-flex">
                        <input type="text" class="w-75 form-control" formControlName="IP" placeholder="000.000.000.000">
                        <button class="actions ms-2" mat-mini-fab matTooltip="Delete" matTooltipPosition="after" type="button"
                            aria-label="Example icon button with a menu icon" (click)="removeCatgoryField(i)">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                </ng-container>
            </div>
        </div>
    </div>


    <div class="form-group">
        <label for="">Would you like to restrict Locations from which employee can mark check in/check out using
            Mobile?</label>
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input" type="radio"
                    formControlName="isRestrictLocationForCheckInCheckOutUsingMobile"
                    id="isRestrictLocationForCheckInCheckOutUsingMobile-Yes" required [value]="true">
                <label class="form-check-label" for="isRestrictLocationForCheckInCheckOutUsingMobile-Yes">
                    Yes
                </label>
            </div>


            <div class="form-check ms-3">
                <input class="form-check-input" formControlName="isRestrictLocationForCheckInCheckOutUsingMobile"
                    type="radio" id="isRestrictLocationForCheckInCheckOutUsingMobile-No" required [value]="false">
                <label class="form-check-label" for="isRestrictLocationForCheckInCheckOutUsingMobile-No">
                    No
                </label>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label for="">Enable Location Capture from Mobile?</label>
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input" type="radio" formControlName="enableLocationCaptureFromMobile"
                    id="enableLocationCaptureFromMobile-Yes" required [value]="true">
                <label class="form-check-label" for="enableLocationCaptureFromMobile-Yes">
                    Yes
                </label>
            </div>


            <div class="form-check ms-3">
                <input class="form-check-input" type="radio" formControlName="enableLocationCaptureFromMobile"
                    id="enableLocationCaptureFromMobile-No" required [value]="false">
                <label class="form-check-label" for="enableLocationCaptureFromMobile-No">
                    No
                </label>
            </div>
        </div>
    </div>

    <div class="form-group" *ngIf="regularisationForm.get('enableLocationCaptureFromMobile').value === 'true'">
        <label for="">Select the Geo-Location API provider</label>
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input" type="radio" formControlName="geoLocationAPIProvider"
                    id="geoLocationAPIProvider-Yes" required value="Google Geo-Location Api">
                <label class="form-check-label" for="geoLocationAPIProvider-Yes">
                    Google Geo-Location Api
                </label>
            </div>

            <div class="form-check ms-3">
                <input class="form-check-input" type="radio" formControlName="geoLocationAPIProvider"
                    id="geoLocationAPIProvider-No" required value="Open Street Map">
                <label class="form-check-label" for="geoLocationAPIProvider-No">
                    Open Street Map
                </label>
            </div>
        </div>
    </div>

    <div class="form-group"
        *ngIf="regularisationForm.get('geoLocationAPIProvider').value === 'Google Geo-Location Api'">
        <label for="">Enter the Google API key</label>
        <input type="text" placeholder="Enter API Key">
    </div>

    <div class="form-group">
        <label for="">Enable Facial/Fingerprint Recognition from Mobile?</label>
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input" type="radio" formControlName="isFacialFingerprintRecognitionFromMobile"
                    id="isFacialFingerprintRecognitionFromMobile-Yes" required [value]="true">
                <label class="form-check-label" for="isFacialFingerprintRecognitionFromMobile-Yes">
                    Yes
                </label>
            </div>


            <div class="form-check ms-3">
                <input class="form-check-input" type="radio" formControlName="isFacialFingerprintRecognitionFromMobile"
                    id="isFacialFingerprintRecognitionFromMobile-No" required [value]="false">
                <label class="form-check-label" for="isFacialFingerprintRecognitionFromMobile-No">
                    No
                </label>
            </div>
        </div>
    </div>

    <div *ngIf="regularisationForm.get('isRestrictLocationForCheckInCheckOutUsingMobile').value === 'true'">
        <div class="form-group">
            <label for="">How would you like assign Locations for each employee?</label>
            <div class="d-flex">
                <div class="form-check">
                    <input class="form-check-input" type="radio" formControlName="howAssignLocationsForEachEmployee"
                        id="howAssignLocationsForEachEmployee-Yes" required value="template_wise">
                    <label class="form-check-label" for="howAssignLocationsForEachEmployee-Yes">
                        Template Wise
                    </label>
                </div>


                <div class="form-check ms-3">
                    <input class="form-check-input" formControlName="howAssignLocationsForEachEmployee" type="radio"
                        id="howAssignLocationsForEachEmployee-No" required value="employee_wise">
                    <label class="form-check-label" for="howAssignLocationsForEachEmployee-No">
                        Employee Wise
                    </label>
                </div>
            </div>
        </div>

        <div class="tableContainer bg-white border p-2">
            <div class="d-flex justify-content-between pb-2">
                <input class="form-control search" type="text" placeholder="Search..." [(ngModel)]="searchText"
                    name="searchText" aria-label="default input example">
                <button class="addBtn" type="button" mat-raised-button (click)="open(addModal);">Add Location</button>
            </div>
            <table>
                <thead>
                    <th>Location</th>
                    <th>Longitude</th>
                    <th>Latitude</th>
                    <th>Radius</th>
                    <th>Action</th>
                </thead>
                <tbody>
                    <tr
                        *ngFor="let location of location , let i = index ">
                        <td>{{location?.Location}}</td>
                        <td>{{location?.Longitude}}</td>
                        <td>{{location?.Latitude}}</td>
                        <td>{{location?.Radius}}</td>
                        <td>
                            <button class="actions" mat-mini-fab  matTooltip="Edit" matTooltipPosition="before" type="button"
                                aria-label="Example icon button with a menu icon">
                                <i class="bi bi-pencil-fill"></i>
                            </button>

                            <button class="actions ms-2" mat-mini-fab title="Delete" type="button"
                                aria-label="Example icon button with a menu icon"
                                (click)="deleteDialog(location._id, i)">
                                <i class="bi bi-trash"></i>
                            </button>


                        </td>
                    </tr>
                </tbody>
            </table>
            
        </div>
    </div>

    <div class="d-flex justify-content-between mt-2">
        <button type="button" (click)="setFormValues()" mat-raised-button>Cancel</button>
        <button type="submit" mat-raised-button class="addBtn">Submit</button>
    </div>

</form>

<ng-template #addModal let-modal>
    <div class="modal-header border-bottom mb-2 pt-0 d-flex justify-content-between">
        <div>
            <h1 class="modal-title text-muted mb-0">Add Location</h1>
        </div>
        <div class="">
            <button type="button" data-bs-dismiss="modal" class="btn-close text-end"
                (click)="modal.dismiss('Cross click')"></button>
        </div>
    </div>

    <div class="">
        <form [formGroup]="locationForm" (ngSubmit)="onSubmissionMap()">
            <!-- <google-map height="300px" width="700px" [center]="center" [zoom]="zoom" (mapClick)="moveMap($event)" (mapMousemove)="move($event)">
            </google-map> -->
            <div id="map" style="height: 300px; width: 700px;"></div>
            <button (click)="getUserLocation()" type="button">Get My Location</button>
            <pre>{{markers | json}}</pre>

            <google-map [height]="300" [width]="700" [center]="center" [zoom]="zoom" (mapClick)="handleMapClick($event)"
                [options]="{ disableDefaultUI: false }">
            </google-map>

            <!-- <google-map
  
  #myGoogleMap

  height="500px"
  width="100%"
  [zoom]="zoom"
  [center]="center"
  [options]="options"
  (mapClick)="eventHandler($event,'mapClick')"
  (mapDblclick)="eventHandler($event,'mapDblclick')"
  (mapDrag)="eventHandler($event,'mapDrag')"
  (mapDragend)="eventHandler($event,'mapDragend')"
  (mapRightclick)="eventHandler($event,'mapRightclick')"
  (positionChanged)="eventHandler($event,'marker_positionChanged')"
  (zoomChanged)="eventHandler($event,'zoomChanged')"
>
  <map-marker
    #markerElem="mapMarker"
    *ngFor="let marker of markers"
    [position]="marker.position"
    [label]="marker.label"
    [title]="marker.title"
    [options]="marker.options"
    (mapClick)="openInfo(markerElem, marker.info)"
  >
  </map-marker>

  <map-info-window>{{ infoContent }}</map-info-window>
</google-map>

<button (click)="zoomIn()">Zoom in</button>
<button (click)="zoomOut()">Zoom out</button>
<button (click)="logCenter()">Log center</button> -->

            <div class="form-group">
                <label for="">Location Label</label>
                <input type="text" formControlName="Location">
            </div>

            <div class="form-group">
                <label>Latitude</label>
                <input type="text" formControlName="Latitude" [value]="markers[0]?.lat">
            </div>
            <div class="form-group">
                <label>Longitude</label>
                <input type="text" formControlName="Longitude" [value]="display?.lng">
            </div>

            <div class="form-group">
                <label for="">Radius</label>
                <input type="text" formControlName="Radius">
            </div>

            <div class="d-flex my-2">
                <button type="reset" mat-raised-button>Cancel</button>
                <button type="submit" class="addBtn" mat-raised-button>Submit</button>
            </div>
        </form>
    </div>
</ng-template>