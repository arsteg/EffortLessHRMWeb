<div class="main-content">
    <div class="container-fluid pt-4">
        <div class="card shadow-sm mb-4 p-2">
            <div class="row align-items-center">
                <div class="col-12 col-md-9">
                    <h1 class="mb-0">Realtime Monitoring</h1>
                </div>
                <div class="col-12 col-md-3 text-md-end">
                    <button mat-stroked-button color="primary" [matMenuTriggerFor]="menu">
                        Export
                        <mat-icon>ios_share</mat-icon>
                    </button>
                    <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="exportToCsv()">CSV</button>
                        <button mat-menu-item (click)="exportToExcel()">XLS</button>
                        <button mat-menu-item (click)="exportToPdf()">PDF</button>
                    </mat-menu>
                </div>
            </div>
        </div>
    
        <div class="row">
            <div class="col-12 col-md-4">
                <div class="card shadow-sm p-2 mb-4">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <mat-icon class="large-icon" color="primary">people</mat-icon>
                            <br>
                            <small class="text-muted mb-0"> Number of Members</small>
                        </div>
                        <div>
                            <h1 class="mb-0">{{realtime?.totalMember}}</h1>
                        </div>
                    </div>
                </div>
            </div>
    
            <div class="col-12 col-md-4">
                <div class="card shadow-sm p-2 mb-4">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <mat-icon class="large-icon" color="accent">groups</mat-icon>
                            <br>
                            <small class="text-muted mb-0">Working Now</small>
                        </div>
                        <div>
                            <h1 class="mb-0">{{realtime?.activeMember}}</h1>
                        </div>
                    </div>
                </div>
            </div>
    
            <div class="col-12 col-md-4">
                <div class="card shadow-sm p-2 mb-4">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <mat-icon class="large-icon" color="primary">do_not_disturb</mat-icon>
                            <br>
                            <small class="text-muted mb-0">Currently Non-Productive</small>
                        </div>
                        <div>
                            <h1 class="mb-0">{{realtime?.totalNonProductiveMember}}</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tableContainer pt-2">
            <div class="row m-0">
                <div class="col-auto">
                    <mat-form-field appearance="fill" density="-3">
                        <mat-label>Select User</mat-label>
                        <mat-select multiple [(ngModel)]="selectedUser">
                            <mat-option *ngFor="let member of members" [value]="member.id" (click)="filterData()">
                                {{member.name | titlecase}}
                            </mat-option>
                        </mat-select>
                        <mat-icon matPrefix>filter_alt</mat-icon>
                    </mat-form-field>
                </div>
                
                <div class="col-auto ms-auto">
                    <button mat-stroked-button *ngIf="showAllUserLiveButton"
                        (click)="multipleUserLiveScreen()">All Users Live Screen</button>
                </div>
            </div>
            
            <div #realTime class="table-responsive">
                <table mat-table [dataSource]="realtime?.onlineUsers" >
    
                    <ng-container matColumnDef="name">
                      <th mat-header-cell *matHeaderCellDef> Online User </th>
                      <td mat-cell *matCellDef="let element"> {{element.user.firstName}} {{element.user.lastName}} </td>
                    </ng-container>
                  
                    <ng-container matColumnDef="project">
                      <th mat-header-cell *matHeaderCellDef> Project </th>
                      <td mat-cell *matCellDef="let element"> {{element.project}} </td>
                    </ng-container>
                  
                    <ng-container matColumnDef="task">
                      <th mat-header-cell *matHeaderCellDef> Task </th>
                      <td mat-cell *matCellDef="let element"> {{element.task}} </td>
                    </ng-container>
                  
                    <ng-container matColumnDef="app">
                      <th mat-header-cell *matHeaderCellDef> App/Website </th>
                      <td mat-cell *matCellDef="let element"> {{element?.app}} </td>
                    </ng-container>

                    <ng-container matColumnDef="action">
                        <th mat-header-cell *matHeaderCellDef> Action </th>
                        <td mat-cell *matCellDef="let element"> 
                            <button mat-stroked-button 
                                (click)="singleUserLiveScreen(element.user.id)">Live&nbsp;Screen</button>
                            </td>
                      </ng-container>
                  
                    <tr mat-header-row *matHeaderRowDef="['name', 'project', 'task', 'app', 'action']"></tr>
                    <tr mat-row *matRowDef="let row; columns: ['name', 'project', 'task', 'app', 'action'];"></tr>
                  </table>
            </div>
        </div>
    </div>
</div>