<div class="position-relative">
    <div class="position-absolute end-0 d-flex mt-1 gap-2">
    <button color="primary" mat-flat-button (click)="clearForm(); isEdit= false; open(modal)">
        {{'payroll.add' | translate}}
    </button>
    </div>
</div>
<hrm-table
    [data]="tableService.dataSource.data"
    [columns]="columns"
    [showSearch]="true"
    [showPaginator]="true"
    [pageSize]="tableService.recordsPerPage"
    [pageSizeOptions]="[5, 10, 25, 50, 100]"
    [totalItems]="tableService.totalRecords"
    [isServerSide]="true"
    (actionClicked)="onAction($event)"
    (pageChanged)="onPageChange($event)"
></hrm-table>

<ng-template #modal>
    <h1 mat-dialog-title>
        {{ (isEdit ? 'payroll.fixed_deduction.modal.update_title' : 'payroll.fixed_deduction.modal.add_title') | translate }}
    </h1>
    <form [formGroup]="fixedContributionForm" (ngSubmit)="onSubmission()">
        <div mat-dialog-content>
            <div class="form-group">
                <mat-form-field class="w-100">
                    <mat-label>{{ 'payroll.fixed_deduction.form.label' | translate }}</mat-label>
                    <input matInput type="text" formControlName="label"
                        [placeholder]="'payroll.fixed_deduction.form.label_placeholder' | translate">
                    <mat-error class="mb-3" *ngIf="!fixedContributionForm.get('label').valid && fixedContributionForm.get('label').touched">
                        <span *ngIf="fixedContributionForm.get('label').errors?.['required']">
                            {{ 'payroll.label_required' | translate }}
                        </span>
                        <span *ngIf="fixedContributionForm.get('label').errors?.['invalidName']">
                            {{ 'payroll.label_name_invalid' | translate }}
                        </span>
                        <span *ngIf="fixedContributionForm.get('label')?.errors?.['spacesNotAllowed']">
                            {{ 'payroll.spacenotallowed' | translate }}
                        </span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="form-group">
                <mat-slide-toggle formControlName="isEffectAttendanceOnEligibility">
                    {{ 'payroll.fixed_deduction.form.isEffectAttendanceOnEligibility' | translate }}
                </mat-slide-toggle>
            </div>
        </div>
        <div mat-dialog-actions class="d-flex border-top mt-2 py-2 justify-content-between">
            <button mat-flat-button type="button" (click)="clearForm(); closeModal()">
                {{ 'payroll.cancel' | translate }}
            </button>
            <button mat-flat-button type="submit" color="primary" [disabled]="isSubmitting">
                {{ (isEdit ? 'payroll.update' : 'payroll.add') | translate }}
            </button>
        </div>
    </form>
</ng-template>