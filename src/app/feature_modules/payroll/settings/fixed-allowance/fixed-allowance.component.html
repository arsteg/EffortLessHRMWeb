<div class="position-relative">
    <div class="position-absolute end-0 d-flex mt-1 gap-2">
        <button color="primary" mat-flat-button
            (click)="isEdit= false; open(modal); fixedAllowanceForm.get('label').enable();">
            {{'payroll.add' | translate}}
        </button>
    </div>
</div>
<hrm-table [data]="tableService.dataSource.data" [columns]="columns" [showSearch]="true" [showPaginator]="true"
    [pageSize]="tableService.recordsPerPage" [pageSizeOptions]="[5, 10, 25, 50, 100]"
    [totalItems]="tableService.totalRecords" [isServerSide]="true" (actionClicked)="onAction($event)"
    (pageChanged)="onPageChange($event)"></hrm-table>

<ng-template #modal>
    <h1 mat-dialog-title translate>{{isEdit ? 'payroll.update_fixed_allowance' : 'payroll.add_fixed_allowance'}}</h1>
    <form [formGroup]="fixedAllowanceForm" (ngSubmit)="onSubmission()">
        <div mat-dialog-content>
            <div class="row">
                <div class="form-group col-md-6">
                    <mat-form-field class="w-100">
                        <mat-label translate>payroll.fixed_allowance_label</mat-label>
                        <input matInput type="text" formControlName="label">
                        <mat-error class="mb-3"
                            *ngIf="!fixedAllowanceForm.get('label').valid && fixedAllowanceForm.get('label').touched">
                            <span *ngIf="fixedAllowanceForm.get('label').errors?.['required']">
                                {{ 'payroll.label_required' | translate }}
                            </span>
                            <span *ngIf="fixedAllowanceForm.get('label').errors?.['invalidName']">
                                {{ 'payroll.label_name_invalid' | translate }}
                            </span>
                            <span *ngIf="fixedAllowanceForm.get('label')?.errors?.['spacesNotAllowed']">
                                {{ 'payroll.spacenotallowed' | translate }}
                            </span>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div class="form-group my-1">
                    <div class="d-flex align-items-center justify-content-between">
                        <label translate>payroll.is_tds_affected</label>
                        <mat-radio-group formControlName="isTDSAffected">
                            <mat-radio-button [value]=true>{{'payroll.yes' | translate}}</mat-radio-button>
                            <mat-radio-button [value]=false>{{'payroll.no' | translate}}</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
                <div class="form-group my-1">
                    <div class="d-flex align-items-center justify-content-between">
                        <label translate>payroll.is_provident_fund_affected</label>
                        <mat-radio-group formControlName="isProvidentFundAffected">
                            <mat-radio-button [value]=true>{{'payroll.yes' | translate}}</mat-radio-button>
                            <mat-radio-button [value]=false>{{'payroll.no' | translate}}</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
                <div class="form-group my-1">
                    <div class="d-flex align-items-center justify-content-between">
                        <label translate>payroll.is_professional_tax_affected</label>
                        <mat-radio-group formControlName="isProfessionalTaxAffected">
                            <mat-radio-button [value]=true>{{'payroll.yes' | translate}}</mat-radio-button>
                            <mat-radio-button [value]=false>{{'payroll.no' | translate}}</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
                <div class="form-group my-1">
                    <div class="d-flex align-items-center justify-content-between">
                        <label translate>payroll.is_esic_affected</label>
                        <mat-radio-group formControlName="isESICAffected">
                            <mat-radio-button [value]=true>{{'payroll.yes' | translate}}</mat-radio-button>
                            <mat-radio-button [value]=false>{{'payroll.no' | translate}}</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
                <div class="form-group my-1">
                    <div class="d-flex align-items-center justify-content-between">
                        <label translate>payroll.is_gratuity_fund_affected</label>
                        <mat-radio-group formControlName="isGratuityFundAffected">
                            <mat-radio-button [value]=true>{{'payroll.yes' | translate}}</mat-radio-button>
                            <mat-radio-button [value]=false>{{'payroll.no' | translate}}</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
                <div class="form-group my-1">
                    <div class="d-flex align-items-center justify-content-between">
                        <label translate>payroll.is_lwf_affected</label>
                        <mat-radio-group formControlName="isLWFAffected">
                            <mat-radio-button [value]=true>{{'payroll.yes' | translate}}</mat-radio-button>
                            <mat-radio-button [value]=false>{{'payroll.no' | translate}}</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
            </div>
            <div class="d-flex border-top mt-2 py-2 justify-content-between" mat-dialog-actions>
                <button mat-flat-button type="button" (click)="closeModal()">{{'payroll.close' | translate}}</button>
                <button mat-flat-button type="submit" color="primary" [disabled]="isSubmitting">
                    {{ (isEdit ? 'payroll.update' : 'payroll.add') | translate }}
                </button>
            </div>
        </div>
    </form>
</ng-template>