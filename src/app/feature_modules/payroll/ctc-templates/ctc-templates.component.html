<div class="main-content mt-2">
  <div class="container-fluid">
    <ng-container *ngIf="showTable">
      <div class="bg-white">
        <div class="d-flex align-items-center px-2 py-1">
          <p class="mb-0 me-auto">
            {{ 'payroll.records_found' | translate: { count: tableService.totalRecords } }}
          </p>
          <div class="d-flex align-items-center">
            <span class="bi bi-search searchIcon"></span>
            <input class="form-control search" type="text"
                   [placeholder]="'payroll.search_placeholder' | translate"
                   [(ngModel)]="tableService.searchText" (input)="tableService.applyFilter()"
                   name="searchText" aria-label="Search CTC templates">
            <button class="addBtn ms-2" mat-raised-button
                    (click)="isEdit = false; navigateToUpdateCTCTemplate();">
              {{ 'payroll.add' | translate }}
            </button>
          </div>
        </div>
        <mat-table [dataSource]="tableService.dataSource">
          <ng-container matColumnDef="name">
            <mat-header-cell *matHeaderCellDef> {{ 'payroll._ctc_templates.table.name' | translate }} </mat-header-cell>
            <mat-cell *matCellDef="let ctc"> {{ ctc?.name }} </mat-cell>
          </ng-container>

          <ng-container matColumnDef="fixedAllowances">
            <mat-header-cell *matHeaderCellDef> {{ 'payroll._ctc_templates.table.fixed_allowances' | translate }} </mat-header-cell>
            <mat-cell *matCellDef="let ctc"> {{ ctc?.ctcTemplateFixedAllowances?.length || 0 }} </mat-cell>
          </ng-container>

          <ng-container matColumnDef="fixedDeductions">
            <mat-header-cell *matHeaderCellDef> {{ 'payroll._ctc_templates.table.fixed_deductions' | translate }} </mat-header-cell>
            <mat-cell *matCellDef="let ctc"> {{ ctc?.ctcTemplateFixedDeductions?.length || 0 }} </mat-cell>
          </ng-container>

          <ng-container matColumnDef="otherAllowances">
            <mat-header-cell *matHeaderCellDef> {{ 'payroll._ctc_templates.table.other_allowances' | translate }} </mat-header-cell>
            <mat-cell *matCellDef="let ctc"> {{ ctc?.ctcTemplateOtherBenefitAllowances?.length || 0 }} </mat-cell>
          </ng-container>

          <ng-container matColumnDef="actions">
            <mat-header-cell *matHeaderCellDef> {{ 'payroll.actions' | translate }} </mat-header-cell>
            <mat-cell *matCellDef="let ctc">
              <button class="actions" mat-mini-fab [matTooltip]="'payroll.edit' | translate" matTooltipPosition="before"
                      (click)="getComponentsDetail(ctc);">
                <i class="bi bi-pencil-fill"></i>
              </button>
              <button class="actions ms-2" mat-mini-fab [matTooltip]="'payroll.delete' | translate" matTooltipPosition="after"
                      aria-label="Delete CTC template" (click)="deleteDialog(ctc?._id)">
                <i class="bi bi-trash"></i>
              </button>
            </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
        </mat-table>
        <mat-paginator [length]="tableService.totalRecords" [pageSize]="tableService.recordsPerPage"
                       [pageSizeOptions]="[5, 10, 25, 50, 100]" (page)="onPageChange($event)">
        </mat-paginator>
      </div>
    </ng-container>
    <router-outlet *ngIf="!showTable"></router-outlet>
  </div>
</div>