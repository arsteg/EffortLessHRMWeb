<div class="d-flex justify-content-between">
    <h1 mat-dialog-title> {{expenseService.isEdit.getValue() == true? 'Update': 'Add'}} Expense</h1>
    <div mat-dialog-actions>
        <button mat-button mat-dialog-close><mat-icon aria-hidden="false" aria-label="Example close icon"
                fontIcon="close"></mat-icon></button>


    </div>
</div>

<div mat-dialog-content>
    <form [formGroup]="expenseReportform">
        <div class="form-group">

            <label for="firstApprovalEmployee">Select Category<span class="text-danger">*</span></label>
            <select name="" id="firstApprovalEmployee" formControlName="expenseCategory" required
                class="ms-2 form-control" [(ngModel)]="selectedCategoryId"
                (ngModelChange)="onCategorySelection($event)">
                <option>Select Category</option>
                <option *ngFor="let category of categories" [value]="category._id">{{category?.label}}</option>
            </select>
        </div>

        <div class="mt-2">
            <label for="">Select Date</label>
            <div class=" col-12 form-group mb-3">
                <input type="text" class="form-control" #dp="bsDatepicker" bsDatepicker [bsValue]="bsValue"
                    [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD' }" formControlName="incurredDate" />
            </div>
        </div>

        <!-- <div class="mt-2">
            <label for="">Select Type</label>
            <div class=" col-12 form-group mb-3">
                <select name="" required class="ms-2 form-control">
                    <option>Select Type</option>
                    <option></option>
                </select>
            </div>
        </div> -->


        <div class="mt-2">
            <label for="">Amount</label>
            <div class=" col-12 form-group mb-3">
                <input type="number" class="form-control" formControlName="amount" />
            </div>
        </div>
        <!-- <pre>{{fieldsValue| json}}</pre>
        <div formArrayName="expenseReportExpenseFields">
            <pre>{{fieldsValue| json}}</pre>
            <ng-container *ngFor="let appField of expenseReportform.get('expenseApplicationField')['controls']; let i = index">
                <div class="form-group" [formGroupName]="i">
                    <pre>{{appField | json}}</pre>
                     <ng-container [ngSwitch]="appField.fieldType">
                        <label>{{ appField?.fieldName }}</label>
                        <select *ngSwitchCase="'Dropdown'" class="form-control"
                            formControlName="value">
                            <option>Select Value</option>
                            <option value="options?.value"
                                *ngFor="let options of appField?.expenseApplicationFieldValues">
                                {{options?.value}}</option>
                        </select>

                        <textarea *ngSwitchCase="'Textfield'" class="form-control"
                            formControlName="value"></textarea>

                        <input *ngSwitchCase="'Number'" type="number" class="form-control"
                            formControlName="value" />

                        <input *ngSwitchCase="'Date'" type="text" class="form-control" #dp="bsDatepicker" bsDatepicker
                            [bsValue]="bsValue" [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD' }"
                            formControlName="value" />

                        <input *ngSwitchCase="'DateRange'" type="text" class="w-100" placeholder="Select Date Range"
                            class="form-control" bsDaterangepicker [(ngModel)]="bsRangeValue"
                            [bsConfig]="{ isAnimated: true }" formControlName="value">
                    </ng-container> 
                </div>
            </ng-container>
        </div> -->
<div formArrayName="fieldsValue">
    <ng-container *ngFor="let fieldGroup of fieldsValue.controls; let i = index">
        <pre>{{fieldGroup| json}}</pre>
        <div [formGroupName]="i">
            <label>{{ applicationfields[i].expenseApplicationField }}</label>
            <ng-container [ngSwitch]="applicationfields[i].fieldType">
                <select *ngSwitchCase="'Dropdown'" class="form-control"
                    formControlName="value">
                    <option>Select Value</option>
                    <option *ngFor="let option of applicationfields[i].expenseApplicationFieldValues"
                        [value]="option.value">{{ option.value }}</option>
                </select>
                <input *ngSwitchCase="'Textfield'" type="text" class="form-control"
                    formControlName="value">
                <input *ngSwitchCase="'Number'" type="number" class="form-control"
                    formControlName="value" />
                <input *ngSwitchCase="'Date'" type="text" class="form-control" #dp="bsDatepicker" bsDatepicker
                    [bsValue]="bsValue" [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD' }"
                    formControlName="value" />
                <input *ngSwitchCase="'DateRange'" type="text" class="w-100" placeholder="Select Date Range"
                    class="form-control" bsDaterangepicker [(ngModel)]="bsRangeValue"
                    [bsConfig]="{ isAnimated: true }" formControlName="value" />
            </ng-container>
        </div>
    </ng-container>
</div>

       
        <section class="example-section">
            <mat-radio-group (change)="toggleIsReimbursable($event)">
                <mat-radio-button class="example-margin" value="true"
                    [checked]="expenseReportform.get('isReimbursable').value === true">Reimbursable</mat-radio-button>
                <mat-radio-button class="example-margin" value="false"
                    [checked]="expenseReportform.get('isBillable').value === true">Billable</mat-radio-button>
            </mat-radio-group>
        </section>

        <div class="mb-3">
            <label for="exampleFormControlTextarea1" class="form-label">
                Reason
            </label>
            <textarea class="form-control" id="exampleFormControlTextarea1" formControlName="reason"
                rows="3"></textarea>
        </div>

        <div class="input-group mb-3">
            <label class="input-group-text" for="inputGroupFile01">Upload</label>
            <input type="file" class="form-control" formControlName="expenseAttachments" (change)="onFileSelect($event)"
                id="inputGroupFile01">
        </div>

        <div>
            <button mat-raised-button type="button">Cancel</button>
            <button mat-button mat-dialog-close type="submit" (click)="onSubmission()">Submit</button>

        </div>


    </form>
</div>